//
// Protocol Buffer definitions for Timber
//

option java_package = "org.cloudname.log.pb";
option optimize_for = SPEED;

// This message represents the envelope of a log message.  These are
// the only fields that the core log server framework should deal with
// minus the payload.  In the interest of simplicity and performance
// the core framework should never mess around with the contents of
// the Payload.  This is a task for the EventHandler implementations.
//
//
message LogEvent {
  // Timestamp is in milliseconds since epoch
  required int64 timestamp = 1;
  
  // The level of this event.
  required int32 level = 2;

  // Hostname of the machine where the log event originated.
  required string host = 3;

  // The name of the service or the application that emitted the
  // event.  If used in conjunction with cloudname this is where
  // we put the primary service coordinate.
  required string service_name = 4;

  // For Java programs the class and method where the log event
  // originated.
  required string source = 5;

  // The type of log event.
  required string type = 6;

  // Zero or more payloads associated with this log event.
  repeated Payload payload = 7;

  // The process id of the originating program.  If unknown this
  // defaults to zero.
  optional int32 pid = 8 [default = 0];

  // The thread id of the originating program.  If unknown this
  // defaults to zero.
  optional int32 tid = 9 [default = 0];
}

// This message represents the payload of a log message.
//
message Payload {
  required string name = 1;

  // The payload.
  required bytes payload = 2;

  // The content type of the event payload.  Modeled after the MIME
  // types used in HTTP.
  optional string content_type = 3;
}